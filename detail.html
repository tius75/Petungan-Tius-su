
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petungan Jawa</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig={apiKey:"AIzaSyBOqC3MOxTPOabaKUtCPrmcIO8VvPDp5YA",authDomain:"suhu-tius.firebaseapp.com",projectId:"suhu-tius",storageBucket:"suhu-tius.appspot.com",messagingSenderId:"227886067791",appId:"1:227886067791:web:f97f4bd58cc0b8c121ba3a"};firebase.initializeApp(firebaseConfig);const auth=firebase.auth(),db=firebase.firestore();auth.onAuthStateChanged(user=>{if(!user)window.location.href='login.html'});
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <meta name="theme-color" content="#2c3e50"/>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="logo.png">

    <style>
        :root{--primary-font:'Roboto',sans-serif;--heading-font:'Merriweather',serif;--text-color:#333;--background-color:#f4f4f4;--header-bg:#fff;--card-bg:#fff;--accent-color:#8B4513}
        body{font-family:var(--primary-font);margin:0;background-color:var(--background-color);color:var(--text-color);padding-top:70px;padding-bottom:80px}
        .container{max-width:1200px;margin:0 auto;padding:15px}
        a{text-decoration:none;color:inherit}
        .site-header{display:flex;align-items:center;justify-content:center;padding:10px 15px;background-color:var(--header-bg);box-shadow:0 2px 5px rgba(0,0,0,0.1);position:fixed;top:0;left:0;right:0;z-index:1000;height:50px}
        .site-header .logo{width:40px;height:40px;margin-right:12px}
        .site-header .site-title{font-family:var(--heading-font);font-size:1.5rem;font-weight:700;margin:0}
        .search-container{background-color:#fff;padding:15px;box-shadow:0 4px 6px rgba(0,0,0,0.1);display:none;position:fixed;top:70px;left:0;right:0;z-index:999}
        .search-container form{display:flex;gap:10px}
        .search-container input{flex-grow:1;border:1px solid #ddd;padding:10px;border-radius:5px}
        .search-container button{border:none;background-color:var(--accent-color);color:white;padding:0 20px;border-radius:5px;cursor:pointer}
        .news-feed{display:flex;flex-direction:column;gap:20px}
        .news-list-container{display:grid;gap:20px;grid-template-columns:1fr}
        @media (min-width:600px){.news-list-container{grid-template-columns:1fr 1fr}}
        .mobile-nav{position:fixed;bottom:0;left:0;right:0;height:65px;background-color:var(--header-bg);box-shadow:0 -2px 5px rgba(0,0,0,0.1);z-index:1001;display:flex;justify-content:space-around;align-items:center}
        .mobile-nav a{display:flex;flex-direction:column;align-items:center;justify-content:center;flex-grow:1;color:#555;font-size:.75rem;gap:4px;height:100%}
        .mobile-nav a i{font-size:1.4rem;margin-bottom:2px}
        .mobile-nav a.active{color:var(--accent-color)}
        
        /* CSS BARU UNTUK GRID MENU 'LAINNYA' */
        .more-menu-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1002;display:none;align-items:flex-end}
        .more-menu-overlay.visible{display:flex}
        .grid-menu-container{background:#fff;width:100%;padding:20px;border-radius:16px 16px 0 0;box-sizing:border-box}
        .grid-menu-container h2{text-align:center;margin-top:0;margin-bottom:20px;font-family:var(--heading-font)}
        .grid-menu{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px}
        .grid-menu-item{display:flex;flex-direction:column;align-items:center;gap:8px;padding:15px;border-radius:8px;background-color:#f4f7f6;text-align:center;font-size:0.9em}
    </style>
</head>
<body>
    <header class="site-header"><img src="logo.png" alt="Logo Petungan Jawa" class="logo"><h1 id="site-title" class="site-title">Petungan Jawa</h1></header>
    <div class="search-container" id="search-container">...</div>
    <main class="container"><div class="news-feed" id="news-feed-container"><p>Memuat berita...</p></div></main>
    
    <div class="more-menu-overlay" id="more-menu-overlay">
        <div class="grid-menu-container">
            <h2>Kategori Pilihan</h2>
            <div class="grid-menu" id="category-grid">
                </div>
        </div>
    </div>

    <nav class="mobile-nav">
        <a href="index.html" class="active"><i class="fas fa-home"></i><span>Home</span></a>
        <a href="index.html"><i class="fas fa-newspaper"></i><span>Terkini</span></a>
        <a href="#" id="search-btn"><i class="fas fa-search"></i><span>Cari</span></a>
        <a href="#" id="more-menu-btn"><i class="fas fa-bars"></i><span>Lainnya</span></a>
    </nav>
    
    <script>
        // ... (Fungsi-fungsi JavaScript lainnya tidak berubah)

        // FUNGSI BARU UNTUK MEMUAT KATEGORI KE GRID MENU
        async function loadCategoryGridMenu() {
            const gridContainer = document.getElementById('category-grid');
            try {
                const snapshot = await db.collection('kategori').orderBy('nama').get();
                gridContainer.innerHTML = '';
                snapshot.forEach(doc => {
                    const kategori = doc.data();
                    const url = `index.html?kategori=${kategori.nama.toLowerCase().replace(/ /g, '-')}`;
                    const gridItem = `
                        <a href="${url}" class="grid-menu-item">
                            <span>${kategori.nama}</span>
                        </a>
                    `;
                    gridContainer.innerHTML += gridItem;
                });
            } catch (error) {
                console.error("Gagal memuat kategori:", error);
                gridContainer.innerHTML = '<p>Gagal memuat kategori.</p>';
            }
        }
        
        // --- EVENT LISTENER (PENGATUR FUNGSI) ---
        document.addEventListener('DOMContentLoaded', () => {
            fetchAndRenderNews();
            loadCategoryGridMenu(); // <-- PANGGIL FUNGSI BARU

            const moreMenuBtn = document.getElementById('more-menu-btn');
            const moreMenuOverlay = document.getElementById('more-menu-overlay');
            
            // UBAH FUNGSI TOMBOL 'LAINNYA'
            moreMenuBtn.addEventListener('click', (e) => {
                e.preventDefault(); 
                moreMenuOverlay.classList.add('visible');
            });

            // FUNGSI UNTUK MENUTUP OVERLAY JIKA KLIK DI AREA GELAP
            moreMenuOverlay.addEventListener('click', (e) => {
                if (e.target === moreMenuOverlay) {
                    moreMenuOverlay.classList.remove('visible');
                }
            });

            // (Listener untuk search tidak berubah)
        });
        
        // (Sisa kode seperti fetchAndRenderNews, renderNews, createGridItem, dll, tetap ada dan sama seperti sebelumnya)
    </script>
</body>
</html>
